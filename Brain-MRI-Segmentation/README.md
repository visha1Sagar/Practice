# Brain MRI Segmentation Using U-Net

This project applies deep learning techniques for automated brain MRI segmentation, using a U-Net model architecture. The main goal is to segment brain images from MRI scans to help in the analysis and study of brain-related conditions.

## Project Overview

Brain MRI segmentation is a crucial step in medical imaging analysis, helping doctors and researchers to isolate and study different brain regions. This project uses a U-Net neural network, a widely adopted architecture in image segmentation tasks, especially in the medical field. The U-Net model was trained on MRI brain images and is able to predict segmented images of brain structures.

## Features

- **U-Net Model**: A custom U-Net model with encoder-decoder architecture designed for semantic segmentation.
- **Data Augmentation**: Includes rotation, width/height shifts, shearing, zooming, and horizontal flips to make the model robust.
- **Training and Testing Pipelines**: Custom generators to load, augment, and preprocess training and testing datasets.

## Requirements

- Python 3.x
- TensorFlow/Keras
- NumPy
- Scikit-image
- Matplotlib

## Getting Started

1. **Data Preparation**:

   - Place your brain MRI images in the `data/brain/train` and `data/brain/test` folders, with separate folders for images and labels.

2. **Training**:

   - The `trainGenerator` in `data.py` handles data augmentation and prepares batches of images and labels for training.
   - Run `main.py` to start training. The model will be saved as `unet_brain.hdf5` in the current directory.

3. **Prediction**:
   - The trained model is used to generate predictions on test images.
   - The `testGenerator` function prepares test images, and results are saved to the `data/brain/test` folder.

## Usage

1. **Training the Model**:

   ```python
   python main.py
   ```

2. **Generating Segmentations**:
   After training, test images can be fed into the model for predictions. The segmented results will be saved as output images.

## Project Structure

- **main.py**: Main script to load data, train the U-Net model, and generate segmentations.
- **model.py**: Defines the U-Net architecture with encoder and decoder layers.
- **data.py**: Contains data processing utilities, including data augmentation, training and testing data generation, and image saving functions.

## Model Architecture

The U-Net architecture used in this project consists of an encoder-decoder structure:

- **Encoder**: Consists of multiple convolutional layers and pooling operations to extract features.
- **Decoder**: Up-sampling layers with skip connections to restore spatial information and segment brain regions in the MRI scans.

## Results and Output

The segmented MRI images generated by the model highlight different brain regions. These output images can be further analyzed or visualized as needed.

## References

- U-Net: Convolutional Networks for Biomedical Image Segmentation (Ronneberger et al., 2015)

This project provides a foundational approach to MRI segmentation using deep learning, which can be extended to more complex models or datasets.
